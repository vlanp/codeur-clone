---
title: Portals
description: Adding JSX elements into a DOM node
nav: 4
id: 381bf47413da81160b1e3481b1c05e0d
---

## Introduction

To save time, the pages of the [codeur.com](https://www.codeur.com/) website were not entirely recreated with [React](https://react.dev/) components. Instead, the generated DOM for each page was retrieved and stored in HTML format. Part of the DOM was then removed to be replaced by JSX generated by [React](https://react.dev/) components in order to have better control over the project list on the homepage "/", as well as over the project, the form for submitting a new offer, and the offer list on a project page "/projects/:id". This addition of JSX into the DOM required the use of [React portals](https://react.dev/reference/react-dom/createPortal).

## Using Portals

When mounting the page, a reference to the container is stored via **_useRef_**. A **_useEffect_** triggers the injection of raw HTML content (previously imported) into this container. Once the HTML is inserted, the element with the desired id is selected and stored in state. When this target element becomes available, the page is re-rendered, and React uses **_createPortal_** to render JSX components directly into this specific DOM node, thus allowing React content to be integrated into a static HTML structure.

```tsx
import html from "./index.html?raw";
import { useEffect, useRef, useState } from "react";
import { createPortal } from "react-dom";
import type { IOffer } from "../../../interfaces/IOffer";
import OfferCard from "../../components/OfferCard";

const ProjectPage = () => {
  const htmlContainerRef = useRef<HTMLDivElement | null>(null);
  const [offersPortalContainer, setOffersPortalContainer] =
    useState<HTMLElement | null>(null);
  const offers: IOffer[] = ...

  useEffect(() => {
    if (htmlContainerRef.current) {
      htmlContainerRef.current.innerHTML = html;
    }
    const offersElement = document.getElementById("offers_placeholder");
    if (!offersElement) {
      throw new Error('An element with id "offers_placeholder" should exist.');
    }
    setOffersPortalContainer(offersElement);
  }, []);

  return (
    <>
      <div ref={htmlContainerRef} />
      {offersPortalContainer &&
        createPortal(
          offers.map((offer) => <OfferCard key={offer.id} offer={offer} />),
          offersPortalContainer
        )}
    </>
  );
};
```

## Problem Encountered

The first approach consisted of using **_dangerouslySetInnerHTML_** to inject the raw HTML. Although JSX injection via a React portal worked with this method, a new render of the component seemed to be performed causing the elements injected into the DOM to disappear.

```tsx
import html from "./index.html?raw";
import { useEffect, useRef, useState } from "react";
import { createPortal } from "react-dom";
import type { IOffer } from "../../../interfaces/IOffer";
import OfferCard from "../../components/OfferCard";

const ProjectPage = () => {
  const [offersPortalContainer, setOffersPortalContainer] =
    useState<HTMLElement | null>(null);
  const offers: IOffer[] = ...

  useEffect(() => {
    const offersElement = document.getElementById("offers_placeholder");
    if (!offersElement) {
      throw new Error('An element with id "offers_placeholder" should exist.');
    }
    setOffersPortalContainer(offersElement);
  }, []);

  return (
    <>
      <div dangerouslySetInnerHTML={{ __html: html }} />
      {offersPortalContainer &&
        createPortal(
          offers.map((offer) => <OfferCard key={offer.id} offer={offer} />),
          offersPortalContainer
        )}
    </>
  );
};
```

This problem is documented [here](https://github.com/facebook/react/issues/31600).
